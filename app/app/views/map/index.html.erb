<style>
  #map {width:100%; height:500px; margin-bottom:40px;}
  #left-nav{height:500px; max-height:500px; overflow-y:scroll;}
</style>

<div class="row">

<div id="left-nav" class="span3">
  <h1>Yelp Data</h1>
  <p>Insert options here.</p>
  <button id="search-btn" class="btn btn-primary"><i class="fa fa-search"></i> Search</button>
</div>

<div class="span9">
<div id="map"></div>
</div>

</div> <!-- /.row -->

<script>

var getData = function (map, heatmapLayer) {

  $.getJSON('/businesses.json', function(data) {

    var businesses = {
      max: 1,
      data: data
    };

    map.setView([businesses.data[0].latitude, businesses.data[0].longitude], 8);
    heatmapLayer.setData(businesses);

  });

};


$(document).ready(function() {

  var baseLayer = L.tileLayer(
    'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{
      attribution: '&copy; <a href="http://openstreetmap.org">OpenStreetMap</a>',
      maxZoom: 18
    }
  );

  var cfg = {
    // radius should be small ONLY if scaleRadius is true (or small radius is intended)
    "radius": 1,
    "maxOpacity": .8, 
    // scales the radius based on map zoom
    "scaleRadius": true, 
    // if set to false the heatmap uses the global maximum for colorization
    // if activated: uses the data maximum within the current map boundaries 
    //   (there will always be a red spot with useLocalExtremas true)
    "useLocalExtrema": false,
    // which field name in your data represents the latitude - default "lat"
    latField: 'latitude',
    // which field name in your data represents the longitude - default "lng"
    lngField: 'longitude',
    // which field name in your data represents the data value - default "value"
    valueField: 'rating'
  };

  var heatmapLayer = new HeatmapOverlay(cfg);

  var map = new L.Map('map', {
    center: new L.LatLng(39.8282, -98.5795),
    zoom: 4,
    layers: [baseLayer, heatmapLayer]
  });

  $('#search-btn').click(function() {
    getData(map, heatmapLayer);
  });

});

</script>

